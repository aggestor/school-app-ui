import{T as M}from"./TextBox-7a965e88.js";import{r as o,o as N,y as j,c as s,a as r,b as p,w,F as _,z as E,g as n,i as C,t as B,B as I}from"./index-4f0251ba.js";import{C as R}from"./category-855ddfae.js";import{P as z}from"./PagesNavigationHeader-c8c7004e.js";import{M as D}from"./models-804a584c.js";import{S as L}from"./set-dcd81a5b.js";import{S as P}from"./SuccessComponent-d31b415f.js";import{R as V}from"./ReusableHeader-d460a56a.js";import{D as S}from"./Datalist-67627a9c.js";import"./ArrowLeftIcon-5af96ac5.js";import"./XMarkIcon-ae1ed58b.js";const F={class:"w-full md:h-[90%] flex justify-center items-center"},H={key:0,class:"md:w-5/12 border w-11/12 md:mb-5 mb-3 mt-10 bg-white __shad shadow-gray-200 flex h-auto rounded p-8 justify-center flex-col"},T=p("p",{class:"text-gray-600 mb-3 text-sm"},"Remplissez le champ ci-bas pour modifier une serie.",-1),U={class:"h-full w-full flex flex-col"},q=["value"],G=["value"],J={class:"w-full flex mt-3 justify-between"},K={key:1,class:"md:w-7/12 border w-[95%] md:mb-5 mb-3 mt-10 md:h-80 bg-white __shad shadow-gray-200 flex rounded justify-center flex-col"},se={__name:"UpdateSet",setup(O){const i=o({}),u=o(""),v=o(""),f=o(""),g=o(0),m=o(0),h=o(0),x=o(!1),d=o([]),c=o([]),y=e=>{if(e.target.name==="category"&&e.target.value.length>2){v.value=e.target.value;const a=d.value.filter(t=>t.name==e.target.value);a[0]&&(g.value=a[0].id,b(a[0].id))}else if(e.target.name==="model"){f.value=e.target.value;const a=c.value.filter(t=>t.mod_name===e.target.value);console.log("mode",a),a[0]&&(m.value=a[0].mod_id)}else u.value=e.target.value},k=async()=>{console.log(m.value);const e=await L.update({name:u.value,category:g.value,model:m.value,id:h.value});e.type==="error"?i.value=e.data:e.type==="success"&&(i.value={},x.value=!0)},A=async()=>{const e=await R.getAll(),a=Array.isArray(e.data)?e.data:[e.data];d.value=a},b=async e=>{const a=await D.getAllByCategory(e);if(a.type==="success"){console.log(a);let t=Array.isArray(a.data)?a.data:[a.data];c.value=t}},l=E();return N(()=>{console.log(l.params),l.params&&(u.value=j(l.params.name,!0),h.value=l.params.id),A().then(()=>{g.value=l.params.category,m.value=l.params.model,v.value=d.value.filter(e=>e.id==l.params.category)[0].name,b(l.params.category).then(()=>{let e=c.value.filter(a=>a.mod_id==l.params.model);f.value=e[0]?e[0].mod_name:""})})}),(e,a)=>(n(),s(_,null,[r(V,{title:"Modification d'une serie"}),p("div",F,[x.value?(n(),s("div",K,[r(P,{path:"/admin/sets",title:"Enregitrement effectué !",message:"La série a été modifiée avec succès. Elle est maintenant utilisable partout. Vous pouvez la modifier mais pas le supprimer définitivément."})])):(n(),s("div",H,[r(z,{title:"Modification d'une serie"}),T,p("form",U,[r(M,{onChange:y,type:"text",name:"name",label:"Nom du type",value:u.value,placeholder:"Nom du type",err:i.value.name},null,8,["value","err"]),r(S,{onChange:y,type:"text",name:"category",label:"Choisir la catégorie",value:v.value,placeholder:"Choisir la catégorie",err:i.value.category},{default:w(()=>[(n(!0),s(_,null,C(d.value,t=>(n(),s("option",{value:t.name,key:t.id},B(t.name),9,q))),128))]),_:1},8,["value","err"]),r(S,{onChange:y,type:"text",name:"model",label:"Choisir le modèle",value:f.value,placeholder:"Choisir le modele",err:i.value.model},{default:w(()=>[(n(!0),s(_,null,C(c.value,t=>(n(),s("option",{value:t.mod_name,key:t.mod_name},B(t.mod_name),9,G))),128))]),_:1},8,["value","err"])]),p("div",J,[r(I,{text:"Enregistrer",variant:"bg",design:"primary",onClick:k})])]))])],64))}};export{se as default};
