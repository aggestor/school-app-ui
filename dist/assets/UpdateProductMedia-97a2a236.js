import{G as z}from"./GoBackAdminButton-a12efcb1.js";import{S}from"./SuccessComponent-d31b415f.js";import{g as s,c as o,b as l,r as c,o as P,a as d,u as n,q as m,F as E,i as N,d as k,z as O,s as f}from"./index-4f0251ba.js";import{P as g}from"./product-f3166d18.js";import{S as F}from"./shop-37c8544f.js";import{u as G}from"./useVerify-b9fe02ca.js";import{g as q}from"./get-video-metadata-608047b0.js";import"./ArrowLeftIcon-5af96ac5.js";import"./XMarkIcon-ae1ed58b.js";function T(p,u){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})])}function D(p,u){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 16.5V9.75m0 0l3 3m-3-3l-3 3M6.75 19.5a4.5 4.5 0 01-1.41-8.775 5.25 5.25 0 0110.233-2.33 3 3 0 013.758 3.848A3.752 3.752 0 0118 19.5H6.75z"})])}function J(p,u){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})])}function C(p,u){return s(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])}const K={class:"h-full w-full flex justify-center items-center"},Q={key:0,class:"w-8/12 mx-auto bg-white rounded p-3 min-h-[80%]"},W={class:"w-full mx-auto flex justify-between items-center"},X={class:"flex"},Y=k(),Z=l("span",{class:"ml-1 mr-1"},"|",-1),ee=l("h1",{class:"md:text-xl font-semibold text-gray-700"},"Modifier les images produit ",-1),te=k("Toutes "),se={class:"w-full flex mt-3 flex-wrap"},oe={class:"w-48 p-3 h-48"},le=["onMouseleave","onMouseenter"],ae={key:0,class:"absolute space-x-2 bottom-0 left-0 w-full z-50 flex p-2"},re=["onClick"],ce=["onClick"],ne=["src","alt"],ue=["src","alt"],ie=["src"],de=["src"],pe={key:0,class:"w-48 h-48 p-3"},he={class:"flex flex-col items-center text-gray-600"},ve=l("small",null,"Ajouter des images",-1),me=k("Uploader les images "),fe={key:1,class:"w-6/12 md:h-[50%]"},Ie={__name:"UpdateProductMedia",setup(p){G();const u=c({}),r=c([]),_=c([]),h=c(""),y=c(!1),w=c(!1),v=c(!0),b=c("inputRef"),M=c({}),I=O(),j=async t=>{const a=await g.get(t);a.type==="success"&&(L(a.data.shop_id),r.value=a.data.files?a.data.files.split(","):[],u.value=a.data)},L=async t=>{const a=await F.get(t);a.type==="success"&&(M.value=a.data)},V=async()=>{(await g.updateMedia(_.value,u.value.prod_id)).type==="success"&&(y.value=!0)},B=t=>{w.value=!0,h.value=t},R=t=>{h.value!==t&&(w.value=!1),h.value=""},A=t=>{},x=async t=>{const a=r.value.filter(i=>i!=t);(await g.removeImage(t)).type==="success"&&(r.value=a)},H=()=>{v.value&&r.value.forEach(t=>x(t)),r.value=[],v.value=!1},U=()=>{b.value.click()},$=t=>{[...t.target.files].forEach(async e=>{if(console.log(e),e.type.includes("video")){const i=await q(e);parseInt(i.duration)<=60&&(r.value.push({type:"video",src:URL.createObjectURL(e)}),_.value.push(e))}else r.value.push({type:"img",src:URL.createObjectURL(e)}),_.value.push(e)}),v.value=!1};return P(()=>j(I.params.id)),(t,a)=>(s(),o("div",K,[y.value?(s(),o("div",fe,[d(S,{path:"/admin/products/"+u.value.prod_id,title:"Images uploadees !",message:"Les nouvelles images ont été uploadées avec succès. Elles est maintenant visibale partout. Vous pouvez le modifier ou le supprimer quand vous voulez."},null,8,["path"])])):(s(),o("div",Q,[l("div",W,[l("div",X,[d(z),Y,Z,ee]),r.value.length>0&v.value?(s(),o("span",{key:0,onClick:H,class:"p-1.5 rounded bg-blue-600 text-white cursor-pointer hover:bg-blue-700 flex items-center justify-around"},[te,d(n(C),{class:"w-5 h-5 ml-1"})])):m("",!0)]),l("div",se,[(s(!0),o(E,null,N(r.value.slice(0,6),e=>(s(),o("div",oe,[l("div",{onMouseleave:i=>R(e),onMouseenter:i=>B(e),class:"w-full h-full border relative rounded"},[h.value===e&&w.value?(s(),o("div",ae,[l("span",{onClick:i=>x(e),class:"bg-black bg-opacity-60 backdrop-blur-sm rounded cursor-pointer grid place-items-center p-0.5"},[d(n(C),{class:"w-6 text-white h-6"})],8,re),l("span",{onClick:i=>A(),class:"bg-black bg-opacity-60 backdrop-blur-sm rounded cursor-pointer grid place-items-center p-0.5"},[d(n(T),{class:"w-6 text-white h-6"})],8,ce)])):m("",!0),typeof e=="string"&&e.includes("IMG")?(s(),o("img",{key:1,class:"object-cover h-full w-full rounded",src:e.includes("blob")?e:n(f)+"/products/"+e,alt:e},null,8,ne)):typeof e!="string"&&e.type=="img"?(s(),o("img",{key:2,class:"object-cover h-full w-full rounded",src:e.src.includes("blob")?e.src:n(f)+"/products/"+e.src,alt:e.src},null,8,ue)):e.type=="video"?(s(),o("video",{key:3,autoplay:"",muted:"",onclick:"e => e.target.play()",src:e.src.includes("blob")?e.src:n(f)+"/products/"+e.src,class:"h-full w-full"},null,8,ie)):(s(),o("video",{key:4,autoplay:"",muted:"",onclick:"e => e.target.play()",src:e.includes("blob")?e:n(f)+"/products/"+e,class:"h-full w-full"},null,8,de))],40,le)]))),256)),r.value.length<=5?(s(),o("div",pe,[l("div",{onClick:U,class:"border h-full w-full rounded grid place-items-center cursor-pointer"},[l("div",he,[d(n(J),{class:"w-10 h-10 text-gray-600"}),ve])])])):m("",!0),l("form",null,[l("input",{hidden:"",multiple:"",onChange:$,type:"file",ref_key:"inputRef",ref:b},null,544)])]),r.value.length>0?(s(),o("span",{key:0,onClick:V,class:"p-1.5 rounded bg-blue-600 text-white cursor-pointer hover:bg-blue-700 flex items-center justify-center"},[me,d(n(D),{class:"w-5 h-5 ml-1"})])):m("",!0)]))]))}};export{Ie as default};
