import{T as D}from"./TextBox-7a965e88.js";import{_ as P,r as o,o as j,y as L,B as V,C as z,c as r,a as c,b as S,w,z as H,f as y,g as l,F as B,i as b,t as k}from"./index-4f0251ba.js";import{B as M}from"./ButtonLink-43715362.js";import{C as F}from"./category-855ddfae.js";import{P as R}from"./PagesNavigationHeader-c8c7004e.js";import{E as U}from"./extension-6b58ca39.js";import{T as q}from"./type-e63f604b.js";import{S as G}from"./spec-4e36dad5.js";import{S as J}from"./SuccessComponent-d31b415f.js";import{D as K}from"./Datalist-67627a9c.js";import{u as O}from"./useVerify-b9fe02ca.js";import"./ArrowLeftIcon-5af96ac5.js";import"./XMarkIcon-ae1ed58b.js";const Q={setup(){O();const v=o({}),d=o(""),f=o(""),a=o(0),g=o(0),_=o(""),h=o(""),u=o(""),i=o(""),x=o(!1),m=o([]),n=o([]),C=o([]),E=async e=>{if(e.target.name==="category"&&e.target.value.length>2){f.value=e.target.value;const t=m.value.filter(p=>p.name==e.target.value);t[0]&&(a.value=t[0].id,I(t[0].id))}else if(e.target.name==="extension"){i.value=e.target.value,u.value="";const t=n.value.filter(p=>p.ext_name===e.target.value);t[0]&&(g.value=t[0].ext_id,A(t[0].ext_id))}else if(e.target.name==="type"){u.value=e.target.value;const t=C.value.filter(p=>p.typ_name===e.target.value);t[0]&&(_.value=t[0].typ_id)}else d.value=e.target.value},N=async()=>{const e=await G.update({name:d.value,category:a.value,extension:g.value,type:_.value,id:h.value});e.type==="error"?v.value=e.data:e.type==="success"&&(v.value={},x.value=!0)},T=async()=>{const e=await F.getAll();m.value=Array.isArray(e.data)?e.data:[e.data]},I=async e=>{const t=await U.getAllByCategory(e);t.type==="success"&&(n.value=Array.isArray(t.data)?t.data:[t.data])},A=async e=>{const t=await q.getAllByExtension(e);t.type==="success"&&(C.value=Array.isArray(t.data)?t.data:[t.data])},s=H();return j(()=>{s.params&&(d.value=L(s.params.name,!0),h.value=s.params.id),T().then(()=>{a.value=s.params.category,g.value=s.params.extension,_.value=s.params.type,f.value=m.value.filter(e=>e.id==s.params.category)[0].name,I(s.params.category).then(()=>{const e=n.value.filter(t=>t.ext_id==s.params.extension);i.value=e[0]?e[0].ext_name:""}).then(()=>{A(s.params.extension).then(()=>{const e=C.value.filter(t=>t.typ_id==s.params.type);u.value=e[0]?e[0].typ_name:""})})})}),{name:d,errors:v,handleInput:E,category:f,extension:i,categories:m,extensions:n,types:C,promptSuccessBox:x,onPressCreate:N,type:u}},components:{ButtonLink:M,Button:V,TextBox:D,CheckCircleIcon:z,PagesNavigationHeader:R,SuccessComponent:J,Datalist:K}},W={class:"w-full md:h-[90%] flex justify-center items-center"},X={key:0,class:"md:w-5/12 border w-11/12 md:mb-5 mb-3 mt-10 bg-white __shad shadow-gray-200 flex h-auto rounded p-8 justify-center flex-col"},Y=S("p",{class:"text-gray-600 mb-3 text-sm"},"Remplissez le champ ci-bas pour enregister un nouveau type.",-1),Z={class:"h-full w-full flex flex-col"},$=["value"],ee=["value"],te=["value"],ae={class:"w-full flex mt-3 justify-between"},ne={key:1,class:"md:w-7/12 border w-[95%] md:mb-5 mb-3 mt-10 md:h-80 bg-white __shad shadow-gray-200 flex rounded justify-center flex-col"};function oe(v,d,f,a,g,_){const h=y("PagesNavigationHeader"),u=y("TextBox"),i=y("Datalist"),x=y("Button"),m=y("SuccessComponent");return l(),r("div",W,[a.promptSuccessBox?(l(),r("div",ne,[c(m,{path:"/admin/specifications",title:"Modification effectuée !",message:"La spec a été modifiée avec succès.Elle est maintenant utilisable partout. Vous pouvez la modifier mais pas la supprimer définitivément."})])):(l(),r("div",X,[c(h,{title:"Modification d'un type"}),Y,S("form",Z,[c(u,{onChange:a.handleInput,type:"text",name:"name",label:"Nom du type",value:a.name,placeholder:"Nom du type",err:a.errors.name},null,8,["onChange","value","err"]),c(i,{onChange:a.handleInput,name:"category",value:a.category,placeholder:"Choisir la catégorie",err:a.errors.category},{default:w(()=>[(l(!0),r(B,null,b(a.categories,n=>(l(),r("option",{value:n.name,key:n.id},k(n.name),9,$))),128))]),_:1},8,["onChange","value","err"]),c(i,{onChange:a.handleInput,name:"extension",value:a.extension,placeholder:"Choisir l'extension",err:a.errors.model},{default:w(()=>[(l(!0),r(B,null,b(a.extensions,n=>(l(),r("option",{value:n.ext_name,key:n.ext_name},k(n.ext_name),9,ee))),128))]),_:1},8,["onChange","value","err"]),c(i,{onChange:a.handleInput,name:"type",value:a.type,placeholder:"Choisir le type",err:a.errors.model},{default:w(()=>[(l(!0),r(B,null,b(a.types,n=>(l(),r("option",{value:n.typ_name,key:n.typ_name},k(n.typ_name),9,te))),128))]),_:1},8,["onChange","value","err"])]),S("div",ae,[c(x,{text:"Enregistrer",variant:"bg",design:"primary",onClick:a.onPressCreate},null,8,["onClick"])])]))])}const _e=P(Q,[["render",oe]]);export{_e as default};
