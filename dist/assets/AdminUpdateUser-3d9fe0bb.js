import{_ as w,g as l,c as a,b as e,t as m,a as r,d,f as u,e as g,C as L,a6 as U,n as V,a7 as T,F,i as N,w as E,q as y,j as P}from"./index-4f0251ba.js";import{r as O}from"./FaceFrownIcon-bef8e4a9.js";import{r as M}from"./LinkIcon-a8f6f23f.js";import{r as v}from"./NoSymbolIcon-7e058231.js";import{r as R}from"./PencilIcon-abb9d0b0.js";import{r as q}from"./PhotoIcon-a21ae8ef.js";import{S as z}from"./shop-37c8544f.js";import{u as b}from"./logout-e8b700e1.js";import{h as D}from"./moment-fbc5633a.js";import{T as H}from"./TextBox-7a965e88.js";import{L as X}from"./location-bd5000e1.js";import{u as G}from"./use-transpiler-49b8a80b.js";import{r as J}from"./CheckIcon-3f9c4abc.js";import{r as K}from"./LockOpenIcon-9e251320.js";const Q={props:{name:String,current:String,onClick:Function},components:{CheckIcon:J}},W=d();function Y(n,s,o,x,t,i){const f=u("CheckIcon");return o.name===o.current?(l(),a("span",{key:0,onClick:s[0]||(s[0]=(...h)=>o.onClick&&o.onClick(...h)),class:"bg-blue-600 cursor-pointer transition-colors duration-500 w-fit flex items-center hover:bg-blue-700 border-2 border-transparent hover text-white rounded-full justify-around px-1 py-0.5"},[e("span",null,m(o.name.charAt(0).toUpperCase()+o.name.slice(1)),1),W,r(f,{class:"h-4 ml-2 w-4"})])):(l(),a("span",{key:1,onClick:s[1]||(s[1]=(...h)=>o.onClick&&o.onClick(...h)),class:"border-2 border-blue-600 flex cursor-pointer transition-colors duration-500 items-center hover:bg-blue-600 hover:text-white text-blue-600 rounded-full justify-around px-1 py-0.5"},[e("span",null,m(o.name.charAt(0).toUpperCase()+o.name.slice(1)),1)]))}const Z=w(Q,[["render",Y]]),$={props:{isActive:String,onClick:Function},components:{NoSymbolIcon:v,LockOpenIcon:K}},ee=e("span",null,"Debloquer",-1),se=d(),te=e("span",null,"Bloquer",-1),ne=d();function oe(n,s,o,x,t,i){const f=u("LockOpenIcon"),h=u("NoSymbolIcon");return o.isActive?(l(),a("span",{key:0,onClick:s[0]||(s[0]=(...p)=>o.onClick&&o.onClick(...p)),class:"bg-green-600 cursor-pointer transition-colors duration-500 w-fit flex items-center hover:bg-green-700 border-2 border-transparent hover text-white rounded-full justify-around px-1 py-0.5"},[ee,se,r(f,{class:"h-4 ml-1 w-4"})])):(l(),a("span",{key:1,onClick:s[1]||(s[1]=(...p)=>o.onClick&&o.onClick(...p)),class:"bg-red-600 cursor-pointer transition-colors duration-500 w-fit flex items-center hover:bg-red-700 border-2 border-transparent hover text-white rounded-full justify-around px-1 py-0.5"},[te,ne,r(h,{class:"h-4 ml-1 w-4"})]))}const re=w($,[["render",oe]]),ie={data(){return{user:{},errors:{},name:"",locations:[],address:"",email:"",mobile:"",type:"",town:"",status:"",picture:null,pictureFile:null,transpiledLocations:[],locationId:"",showShopSearcher:!1,showSearchBox:!1,loading:!1,shops:[],searchBoxId:0,searchBoxValue:"",assignShowSuccess:!1}},mounted(){this.getUser().then(()=>this.getLocation())},methods:{async getUser(){const n=await g.getUser(this.$route.params.id);n.type==="success"&&(this.user=n.data,this.type=n.data.type,this.status=n.data.status),b(n).then(s=>{s==="success"&&this.$router.push("/admin/login")})},async getUserShopAndBranches(){const n=await g.getShopAndBranches(this.$route.params.id);console.log(n)},moment(){return D()},handleInput(n){if(this[n.target.name]=n.target.value,n.target.name==="town"){const s=this.locations.filter(o=>o.name===n.target.value);s[0]?(this.locationId=s[0].id,this.errors.town=void 0):this.errors.town="Ville choisie invalide !"}},async getLocation(){const n=await X.getAll();if(b(n).then(s=>s==="success"?this.$router.push("/admin/login"):null),n.type==="success"){this.locations=n.data;const s=this.locations.filter(o=>o.id==this.user.location_id);s[0]?this.town=s[0].name:this.errors.town="Ville choisie invalide !"}this.transpiledLocations=G(n,{key:"id".id,value:"name"})},async handleSearchShop(n){const s=n.target.value;if(this.searchBoxValue=s,this.searchBoxId="",s&&s.length>=2){this.showSearchBox=!0,this.loading=!0;const o=await z.search(s);o.type==="success"&&(Array.isArray(o.data)?this.shops=o.data:this.shops=[o.data]),this.loading=!1}else this.showSearchBox=!1},chooseShop(n){this.searchBoxId=n.id,this.searchBoxValue=n.name,this.showSearchBox=!1},async assignUserToShop(){const n={user:this.$route.params.id,shop:this.searchBoxId},s=await g.assignOwnerToShop(n);s&&s.type==="success"&&(this.assignShowSuccess=!0)},hideAssignSuccessBox(){this.searchBoxId="",this.searchBoxValue="",this.shops=[],this.assignShowSuccess=!1},handleClickRef(){this.$refs.input.click()},loadImage(n){const s=URL.createObjectURL(n.target.files[0]);this.picture=s,this.pictureFile=n.target.files[0]}},components:{CheckCircleIcon:L,NoSymbolIcon:v,PencilIcon:R,PhotoIcon:q,TextBox:H,BadgeEditUserTypeVue:Z,LinkIcon:M,BuildingStorefrontIcon:U,HomeModernIcon:V,BadgeEditUserStatus:re,FaceFrownIcon:O,XMarkIcon:T}},le={class:"w-full h-full grid place-items-center"},ae={class:"w-[95%] h-[95%] grid space-x-6 grid-cols-12"},ce={class:"col-span-6 h-full p-3 rounded bg-white shadow"},ue={class:"h-40 border relative rounded-full w-40 mx-auto"},de=["src"],he={class:"w-full mt-4 text-gray-700 h-40"},me={class:"flex items-center mb-1 justify-between w-full"},pe=e("span",null,"Nom",-1),fe={class:"w-56"},_e={class:"flex mb-1 items-center justify-between w-full"},ge=e("span",null,"Email",-1),we={class:"w-56"},xe={class:"flex mb-1 items-center justify-between w-full"},ye=e("span",null,"Téléphone",-1),be={class:"w-56"},ve={class:"flex mb-1 items-center justify-between w-full"},ke=e("span",null,"Address",-1),Ce={class:"w-56"},Se={class:"flex mb-1 items-center justify-between w-full"},Ie=e("span",null,"Ville",-1),Be={class:"w-56"},je={class:"flex mb-3 justify-between w-full"},Ae=e("span",null,"Type",-1),Le={class:"w-[50%] flex items-center justify-around"},Ue={class:"flex mb-3 justify-between w-full"},Ve=e("span",null,"Actif",-1),Te={class:"w-[50%] flex items-center justify-around"},Fe={class:"flex mb-3 justify-between w-full"},Ne=e("span",null,"Dernière modification",-1),Ee={class:"flex items-center text-gray-700"},Pe={class:"col-span-6 h-full rounded grid grid-cols-1"},Oe={class:"h-[275px] mb-6 flex items-center justify-center bg-white shadow col-span-1 rounded"},Me={key:0,class:"flex h-fit justify-center items-center flex-col w-fit"},Re={key:0,class:"w-9/12 mx-auto flex justify-center flex-col items-center"},qe=e("span",{class:"my-3 w-72 text-sm"},"Pour le moment cet utilisateur ne possède aucun shop. Associez-lui a un shop maintenant",-1),ze=d("Associer à un shop "),De={key:1,class:"w-10/12 mx-auto"},He=e("span",{class:"my-3 w-72 text-sm"},"Pour le moment cet utilisateur ne possède aucun shop. Associez-lui a un shop maintenant",-1),Xe={class:"relative max-h-96 mt-1 border rounded p-1 w-full"},Ge=["value","placeholder"],Je={key:0,"data-aos-duration":"300",class:"w-full shadow z-50 absolute top-10 rounded p-2 h-60 bg-white border left-0 mt-1"},Ke={key:0,class:"w-full animate-pulse"},Qe=P('<div class="w-full flex justify-between mt-3 h-8"><span class="w-20 h-2 rounded bg-gray-300"></span><span class="w-5 h-2 rounded bg-gray-300"></span></div><div class="w-full flex justify-between h-8"><span class="w-32 h-2 rounded bg-gray-300"></span><span class="w-5 h-2 rounded bg-gray-300"></span></div><div class="w-full flex justify-between h-8"><span class="w-14 h-2 rounded bg-gray-300"></span><span class="w-5 h-2 rounded bg-gray-300"></span></div><div class="w-full flex justify-between h-8"><span class="w-40 h-2 rounded bg-gray-300"></span><span class="w-5 h-2 rounded bg-gray-300"></span></div><div class="w-full flex justify-between h-8"><span class="w-20 h-2 rounded bg-gray-300"></span><span class="w-5 h-2 rounded bg-gray-300"></span></div>',5),We=[Qe],Ye={key:1,class:"w-full"},Ze=["onClick"],$e=d(),es={key:2,class:"w-full h-full grid text-gray-600 place-items-center"},ss={class:"w-fit flex flex-col items-center h-fit"},ts={class:"w-9/12 mx-auto text-center"},ns=d("Aucun resultat pour ce nom de shop. Verifier l'orthographe ou "),os=d("créer d'abord ce shop"),rs=d(" ."),is={key:1,class:"flex w-11/12 items-center justify-between p-2 h-[80%] relative"},ls={class:"w-[70%] flex flex-col h-[90]"},as=e("span",{class:"text-green-600 mb-3 font-semibold text-xl"},"Utilisateur assigné",-1),cs=d("L'utilisateur "),us={class:"font-semibold"},ds=d(" a été assigné au shop "),hs={class:"font-semibold"},ms=d(" avec succès. Il peut maintenant gérer le shop en tant que Propriétaire (Owner)."),ps={class:"h-[275px] mb-6 flex items-center justify-center bg-white shadow col-span-1 rounded"},fs={class:"flex h-fit justify-center items-center flex-col w-fit"},_s=e("span",{class:"my-3 w-72 text-sm"},"Pour le moment cet utilisateur n'est associé à aucune branche. Associez-lui a une branche maintenant",-1),gs={class:"bg-gray-800 cursor-pointer px-1 py-1 w-fit text-white flex justify-around rounded"},ws=d("Associer à une branche ");function xs(n,s,o,x,t,i){const f=u("PhotoIcon"),h=u("TextBox"),p=u("BadgeEditUserTypeVue"),k=u("BadgeEditUserStatus"),C=u("BuildingStorefrontIcon"),_=u("LinkIcon"),S=u("FaceFrownIcon"),I=u("router-link"),B=u("CheckCircleIcon"),j=u("XMarkIcon"),A=u("HomeModernIcon");return l(),a("div",le,[e("div",ae,[e("div",ce,[e("div",ue,[e("input",{accept:"image/jpeg,image/png",hidden:"",ref:"input",type:"file",name:"file",onChange:s[0]||(s[0]=(...c)=>i.loadImage&&i.loadImage(...c))},null,544),e("img",{src:t.picture!=null?t.picture:"/images/placeholder.jpg",class:"w-full rounded-full h-full object-contain"},null,8,de),e("span",{onClick:s[1]||(s[1]=(...c)=>i.handleClickRef&&i.handleClickRef(...c)),class:"absolute bottom-3 right-3 cursor-pointer hover:bg-gray-700 bg-gray-800 flex justify-around items-center text-white rounded p-1"},[r(f,{class:"w-5 h-5"})])]),e("div",he,[e("div",me,[pe,e("div",fe,[r(h,{hideLabel:!0,onChange:i.handleInput,type:"text",name:"name",value:t.name||t.user.name,err:t.errors.name},null,8,["onChange","value","err"])])]),e("div",_e,[ge,e("div",we,[r(h,{hideLabel:!0,onChange:i.handleInput,type:"email",name:"email",value:t.email||t.user.email,err:t.errors.email},null,8,["onChange","value","err"])])]),e("div",xe,[ye,e("div",be,[r(h,{hideLabel:!0,onChange:i.handleInput,type:"text",name:"mobile",value:t.mobile||t.user.mobile,err:t.errors.mobile},null,8,["onChange","value","err"])])]),e("div",ve,[ke,e("div",Ce,[r(h,{hideLabel:!0,onChange:i.handleInput,type:"text",name:"name",value:t.address||t.user.address,err:t.errors.address},null,8,["onChange","value","err"])])]),e("div",Se,[Ie,e("div",Be,[r(h,{hideLabel:!0,onChange:i.handleInput,list:"locations",items:t.transpiledLocations,type:"text",name:"name",value:t.town,err:t.errors.town},null,8,["onChange","items","value","err"])])]),e("div",je,[Ae,e("div",Le,[r(p,{onClick:()=>this.type="normal",name:"normal",current:t.type},null,8,["onClick","current"]),r(p,{onClick:()=>this.type="manager",name:"manager",current:t.type},null,8,["onClick","current"]),r(p,{onClick:()=>this.type="owner",name:"owner",current:t.type},null,8,["onClick","current"])])]),e("div",Ue,[Ve,e("div",Te,[r(k,{isActive:this.status,onClick:()=>this.status=!this.status},null,8,["isActive","onClick"])])]),e("div",Fe,[Ne,e("span",Ee,m(i.moment(t.user.created_at).startOf("days").fromNow()),1)])])]),e("div",Pe,[e("div",Oe,[t.assignShowSuccess?(l(),a("div",is,[e("div",ls,[as,e("span",null,[cs,e("span",us,m(t.user.name),1),ds,e("span",hs,m(t.searchBoxValue),1),ms])]),r(B,{class:"h-32 text-green-600 w-32"}),e("span",{onClick:s[5]||(s[5]=(...c)=>i.hideAssignSuccessBox&&i.hideAssignSuccessBox(...c)),class:"w-8 absolute right-0 top-0 h-8 rounded hover:bg-gray-300 cursor-pointer bg-gray-200 text-gray-700 grid place-items-center"},[r(j,{class:"h-7 w-7"})])])):(l(),a("div",Me,[r(C,{class:"h-16 w-16 text-gray-600"}),t.showShopSearcher===!1?(l(),a("div",Re,[qe,e("span",{onClick:s[2]||(s[2]=c=>t.showShopSearcher=!0),class:"bg-gray-800 cursor-pointer px-1 py-1 w-fit text-white flex justify-around rounded"},[ze,r(_,{class:"ml-2 h-5 w-5"})])])):(l(),a("div",De,[He,e("div",Xe,[e("input",{onInput:s[3]||(s[3]=(...c)=>i.handleSearchShop&&i.handleSearchShop(...c)),value:t.searchBoxValue,class:"h-8 w-full outline-none",placeholder:`Taper le nom du shop à associer à ${t.user.name}`},null,40,Ge),t.showSearchBox?(l(),a("div",Je,[t.loading?(l(),a("div",Ke,We)):!t.loading&&t.shops.length>0?(l(),a("div",Ye,[(l(!0),a(F,null,N(t.shops,c=>(l(),a("div",{onClick:()=>i.chooseShop(c),class:"w-full hover:bg-gray-100 cursor-pointer rounded p-1 flex justify-between",key:c.id},[e("span",null,m(c.name),1),$e,e("span",null,m(c.level),1)],8,Ze))),128))])):(l(),a("div",es,[e("div",ss,[r(S,{class:"h-16 w-16 mb-2"}),e("small",ts,[ns,r(I,{class:"text-blue-600 font-semibold",to:"/admin/shops/new"},{default:E(()=>[os]),_:1}),rs])])]))])):y("",!0)]),t.searchBoxId?(l(),a("span",{key:0,onClick:s[4]||(s[4]=(...c)=>i.assignUserToShop&&i.assignUserToShop(...c)),class:"bg-gray-800 cursor-pointer px-1 mt-2 py-1 w-fit text-white flex justify-around rounded"},[d("Associer à "+m(t.searchBoxValue)+" ",1),r(_,{class:"ml-2 h-5 w-5"})])):y("",!0)]))]))]),e("div",ps,[e("div",fs,[r(A,{class:"h-16 w-16 text-gray-600"}),_s,e("span",gs,[ws,r(_,{class:"ml-2 h-5 w-5"})])])])])])])}const Fs=w(ie,[["render",xs]]);export{Fs as default};
