import{G as V}from"./GoBackAdminButton-a12efcb1.js";import{S as $}from"./SuccessComponent-d31b415f.js";import{g as r,c as n,b as s,r as c,o as F,a as d,u as h,F as x,i as y,w as L,d as f,z as q,f as E,t as m,C as G}from"./index-4f0251ba.js";import{P as k}from"./product-f3166d18.js";import{S as U}from"./shop-37c8544f.js";import{u as D}from"./useVerify-b9fe02ca.js";import{T as I}from"./TextBox-7a965e88.js";import{r as R}from"./XMarkIcon-ae1ed58b.js";import{S as W}from"./spec-4e36dad5.js";import"./ArrowLeftIcon-5af96ac5.js";function C(j,i){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.671-1.34l.041-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})])}const H={class:"h-full w-full flex justify-center overflow-y-scroll items-center"},Q={key:0,class:"md:w-10/12 w-11/12 mx-auto bg-white rounded p-3 h-auto md:min-h-[80%]"},X={class:"w-full mx-auto flex justify-between items-center"},Y={class:"flex"},Z=f(),ee=s("span",{class:"ml-1 mr-1"},"|",-1),se=s("h1",{class:"md:text-xl font-semibold text-gray-700"},"Modifier mots clés et les spécifications ",-1),te={class:"flex flex-col md:flex-row md:space-x-3 w-full"},oe={class:"md:w-1/2 w-full p-2"},ae={class:"mt-3 flex items-center top-1 left-0 rounded text-gray-700 font-semibold"},le=f("Ajouter les mots clés "),re={class:"w-full flex flex-wrap rounded border p-1 h-64 overflow-auto __scrollbar"},ne={class:"border border-blue-600 text-blue-600 text-xs m-1 h-fit flex items-center space-x-2 rounded-full px-1 py-0.5 w-fit"},ce=f(),de=["onClick"],ie={class:"md:w-1/2 w-full p-3 rounded"},ue={class:"flex justify-around flex-col items-center w-full h-full"},pe={class:"flex items-center rounded w-full mb-2 text-gray-700 font-semibold"},fe=f("Ajouter les specifications "),me={class:"flex w-full border md:max-h-[500px] md:min-h-[100px] overflow-auto rounded p-2 flex-col"},_e={class:"w-4/12 p-1 rounded"},he=["onChange"],ve=["value"],we=["value"],xe={class:"flex flex-col md:flex-row items-center justify-between"},ye=f("Finaliser la modification "),ge={key:1,class:"md:w-6/12 w-10/12 md:h-[50%]"},Me={__name:"UpdateProductKeyWordsAndSpecs",setup(j){D();const i=c({}),g=c(!1),u=c([]),v=c(""),_=c([]),p=c([]),A=c({}),b=c({}),N=q(),B=async t=>{const e=await k.get(t);e.type==="success"&&(O(e.data.shop_id),u.value=e.data.keywords?e.data.keywords.split(","):[],_.value=e.data.details?Array.isArray(JSON.parse(e.data.details))?JSON.parse(e.data.details):[JSON.parse(e.data.details)]:[],i.value=e.data,p.value=e.data.details?Array.isArray(JSON.parse(e.data.details))?JSON.parse(e.data.details):[JSON.parse(e.data.details)]:[],K(e.data.type_id))},O=async t=>{const e=await U.get(t);e.type==="success"&&(A.value=e.data)},J=async()=>{console.log("specs",p.value);const t={keywords:u.value.join(),specs:JSON.stringify(p.value),id:i.value.prod_id};(await k.updateKeywordsAndSpecs(t)).type==="success"&&(g.value=!0)},M=t=>{const e=t.target.value;if(v.value=e,e.slice(-1)===","){const o=e.slice(0,-1);u.value.includes(o)?b.value.keywords="Le mot clé doit être unique.":u.value.push(o),v.value=""}},z=t=>{const e=u.value.filter(o=>o!=t);u.value=e},K=async t=>{const e=await W.getByType(t);if(e.type==="success"){const o=e.data[0];if(o){const l=Object.entries(o),a=[];l.forEach(w=>{const S=_.value.filter(T=>T.name==w[0]);a.push({name:w[0],data:w[1],default:S[0]?S[0].value:"---"})}),_.value=a}}};F(()=>{B(N.params.id)});const P=(t,e)=>{let o=p.value;p.value.filter(a=>a.name==e)[0]?(o=p.value.filter(a=>a.name!==e),o.push({name:e,value:t.target.value})):o.push({name:e,value:t.target.value}),p.value=o};return(t,e)=>{const o=E("router-link");return r(),n("div",H,[g.value?(r(),n("div",ge,[d($,{path:"/admin/products/"+i.value.prod_id,title:"Modifcation effectuée !",message:`Les nouvelles modifications apportées au produit ${i.value.prod_name} ont été appliquées avec succès.`},null,8,["path","message"])])):(r(),n("div",Q,[s("div",X,[s("div",Y,[d(V),Z,ee,se])]),s("form",te,[s("div",oe,[s("span",ae,[d(h(C),{class:"h-6 mr-3 w-6"}),le]),d(I,{onChange:M,type:"text",name:"keyword",label:"Mots clés (separez par une virgule)",value:v.value,placeholder:"Ajouter des mots cles sur ce produit",err:b.value.keyword},null,8,["value","err"]),s("div",re,[(r(!0),n(x,null,y(u.value,l=>(r(),n("span",ne,[s("span",null,m(l),1),ce,s("span",{onClick:a=>z(l),class:"w-5 h-5 grid place-items-center cursor-pointer rounded-full bg-blue-200"},[d(h(R),{class:"w-[14px] h-[14px]"})],8,de)]))),256))])]),s("div",ie,[s("div",ue,[s("span",pe,[d(h(C),{class:"h-6 mr-3 w-6"}),fe]),s("div",me,[(r(!0),n(x,null,y(_.value,l=>(r(),n("div",{class:"w-full flex my-1 justify-between",key:l.name},[s("span",_e,m(l.name),1),s("select",{onChange:a=>P(a,l.name),class:"w-4/12 border-2 duration-500 transition-all outline-none focus:border-2 focus:border-blue-600 rounded p-1"},[s("option",{class:"bg-gray-700 text-white",value:l.default},m(l.default),9,ve),(r(!0),n(x,null,y(l.data,a=>(r(),n("option",{key:a.specd_name,value:a.specd_name},m(a.specd_name),9,we))),128))],40,he)]))),128))])])])]),s("div",xe,[d(o,{to:"/admin/products/"+i.value.prod_id,class:"h-auto w-fit underline text-blue-600 flex items-center"},{default:L(()=>[f(m(i.value.prod_name),1)]),_:1},8,["to"]),s("span",{onClick:J,class:"p-1.5 rounded bg-blue-600 text-white cursor-pointer hover:bg-blue-700 md:w-4/12 w-full flex mt-2 md:mt-0 items-center justify-center"},[ye,d(h(G),{class:"w-5 h-5 ml-1"})])])]))])}}};export{Me as default};
